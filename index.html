<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>AR 空間追蹤版 (不靠GPS)</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
        .ui {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            z-index: 100; background: rgba(0,0,0,0.8); color: white;
            padding: 20px; border-radius: 15px; text-align: center; width: 80%;
        }
        button { padding: 10px 20px; font-size: 18px; background: #007bff; color: white; border: none; border-radius: 5px; }
    </style>
</head>
<body>

    <div class="ui" id="overlay">
        <p>請站在起始點，面向前方</p>
        <button onclick="startExperience()">設定起始點並開始</button>
    </div>

    <a-scene webxr="optionalFeatures: hit-test, local-floor" renderer="antialias: true;">
        
        <a-entity id="maze">
            <a-box position="0 1 -3" material="color: red; opacity: 0.7;"></a-box>
            <a-box position="2 1 -5" material="color: green; opacity: 0.7;"></a-box>
            <a-box position="-2 1 -5" material="color: blue; opacity: 0.7;"></a-box>
            
            <a-grid></a-grid>
        </a-entity>

        <a-camera position="0 1.6 0" look-controls wasd-controls-enabled="false">
        </a-camera>

        <a-sky id="sky" color="#ECECEC" opacity="0"></a-sky> 
    </a-scene>

    <script>
        function startExperience() {
            document.getElementById('overlay').style.display = 'none';
            
            // 請求權限 (iOS 必要)
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission();
            }
            
            // 進入 VR/AR 模式，讓瀏覽器啟動空間追蹤
            const scene = document.querySelector('a-scene');
            if (scene.enterVR) {
                // 在手持裝置上，這會切換到 WebXR 模式
                console.log("進入空間追蹤模式");
            }
        }
    </script>
</body>
</html>
